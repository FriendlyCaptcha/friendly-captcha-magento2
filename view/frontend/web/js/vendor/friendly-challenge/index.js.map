{"version":3,"file":"index.js","sources":["../node_modules/friendly-pow/wasm/optimized.wrap.ts","../node_modules/friendly-pow/base64.js","../node_modules/friendly-pow/constants.js","../src/dom.ts","../src/headless.ts","../node_modules/friendly-pow/encoding.js","../node_modules/friendly-pow/puzzle.js","../src/puzzle.ts","../src/localization.ts","../src/captcha.ts"],"sourcesContent":["// WARNING: This file was autogenerated by wasmwrap and should not be edited manually.\n\nexport const base64 = \"AGFzbQEAAAABKghgAABgAn9/AGADf39/AX9gAX8AYAR/f39/AGAAAX9gAX8Bf2ACf38BfwINAQNlbnYFYWJvcnQABAMMCwcGAwAAAQIFAQIABQMBAAEGFgR/AUEAC38BQQALfwBBAwt/AEHgDAsHbgkGbWVtb3J5AgAHX19hbGxvYwABCF9fcmV0YWluAAIJX19yZWxlYXNlAAMJX19jb2xsZWN0AAQHX19yZXNldAAFC19fcnR0aV9iYXNlAwMNVWludDhBcnJheV9JRAMCDHNvbHZlQmxha2UyYgAKCAELCvgSC5IBAQV/IABB8P///wNLBEAACyMBQRBqIgQgAEEPakFwcSICQRAgAkEQSxsiBmoiAj8AIgVBEHQiA0sEQCAFIAIgA2tB//8DakGAgHxxQRB2IgMgBSADShtAAEEASARAIANAAEEASARAAAsLCyACJAEgBEEQayICIAY2AgAgAkEBNgIEIAIgATYCCCACIAA2AgwgBAsEACAACwMAAQsDAAELBgAjACQBC7sCAQF/AkAgAUUNACAAQQA6AAAgACABakEEayICQQA6AAMgAUECTQ0AIABBADoAASAAQQA6AAIgAkEAOgACIAJBADoAASABQQZNDQAgAEEAOgADIAJBADoAACABQQhNDQAgAEEAIABrQQNxIgJqIgBBADYCACAAIAEgAmtBfHEiAmpBHGsiAUEANgIYIAJBCE0NACAAQQA2AgQgAEEANgIIIAFBADYCECABQQA2AhQgAkEYTQ0AIABBADYCDCAAQQA2AhAgAEEANgIUIABBADYCGCABQQA2AgAgAUEANgIEIAFBADYCCCABQQA2AgwgACAAQQRxQRhqIgFqIQAgAiABayEBA0AgAUEgTwRAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCABQSBrIQEgAEEgaiEADAELCwsLcgACfyAARQRAQQxBAhABIQALIAALQQA2AgAgAEEANgIEIABBADYCCCABQfD///8DIAJ2SwRAQcAKQfAKQRJBORAAAAsgASACdCIBQQAQASICIAEQBiAAKAIAGiAAIAI2AgAgACACNgIEIAAgATYCCCAAC88BAQJ/QaABQQAQASIAQQxBAxABQYABQQAQBzYCACAAQQxBBBABQQhBAxAHNgIEIABCADcDCCAAQQA2AhAgAEIANwMYIABC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\";\n\n","// Adapted from the base64-arraybuffer package implementation\r\n// (https://github.com/niklasvh/base64-arraybuffer, MIT licensed)\r\nconst CHARS = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\nconst EQ_CHAR = \"=\".charCodeAt(0);\r\n// Use a lookup table to find the index.\r\nconst lookup = new Uint8Array(256);\r\nfor (let i = 0; i < CHARS.length; i++) {\r\n    lookup[CHARS.charCodeAt(i)] = i;\r\n}\r\nexport function encode(bytes) {\r\n    const len = bytes.length;\r\n    let base64 = \"\";\r\n    for (let i = 0; i < len; i += 3) {\r\n        const b0 = bytes[i + 0];\r\n        const b1 = bytes[i + 1];\r\n        const b2 = bytes[i + 2];\r\n        base64 += CHARS.charAt(b0 >>> 2);\r\n        base64 += CHARS.charAt(((b0 & 3) << 4) | (b1 >>> 4));\r\n        base64 += CHARS.charAt(((b1 & 15) << 2) | (b2 >>> 6));\r\n        base64 += CHARS.charAt(b2 & 63);\r\n    }\r\n    if (len % 3 === 2) {\r\n        base64 = base64.substring(0, base64.length - 1) + \"=\";\r\n    }\r\n    else if (len % 3 === 1) {\r\n        base64 = base64.substring(0, base64.length - 2) + \"==\";\r\n    }\r\n    return base64;\r\n}\r\nexport function decode(base64) {\r\n    const len = base64.length;\r\n    let bufferLength = len * 3 >>> 2; // * 0.75\r\n    if (base64.charCodeAt(len - 1) === EQ_CHAR)\r\n        bufferLength--;\r\n    if (base64.charCodeAt(len - 2) === EQ_CHAR)\r\n        bufferLength--;\r\n    const bytes = new Uint8Array(bufferLength);\r\n    for (let i = 0, p = 0; i < len; i += 4) {\r\n        const encoded1 = lookup[base64.charCodeAt(i + 0)];\r\n        const encoded2 = lookup[base64.charCodeAt(i + 1)];\r\n        const encoded3 = lookup[base64.charCodeAt(i + 2)];\r\n        const encoded4 = lookup[base64.charCodeAt(i + 3)];\r\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\r\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\r\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\r\n    }\r\n    return bytes;\r\n}\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZTY0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2Jhc2U2NC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw2REFBNkQ7QUFDN0QsaUVBQWlFO0FBRWpFLE1BQU0sS0FBSyxHQUFHLGtFQUFrRSxDQUFDO0FBQ2pGLE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFFbEMsd0NBQXdDO0FBQ3hDLE1BQU0sTUFBTSxHQUFHLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQ25DLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO0lBQ3JDLE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0NBQ2pDO0FBRUQsTUFBTSxVQUFVLE1BQU0sQ0FBQyxLQUFpQjtJQUN0QyxNQUFNLEdBQUcsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO0lBQ3pCLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztJQUVoQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDL0IsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN4QixNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hCLE1BQU0sRUFBRSxHQUFHLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDeEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLE1BQU0sSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0RCxNQUFNLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEQsTUFBTSxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2pDO0lBRUQsSUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUNqQixNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7S0FDdkQ7U0FBTSxJQUFJLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3hCLE1BQU0sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztLQUN4RDtJQUVELE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUM7QUFFRCxNQUFNLFVBQVUsTUFBTSxDQUFDLE1BQWM7SUFDbkMsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUMxQixJQUFJLFlBQVksR0FBRyxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFNBQVM7SUFFM0MsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsS0FBSyxPQUFPO1FBQUUsWUFBWSxFQUFFLENBQUM7SUFDM0QsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsS0FBSyxPQUFPO1FBQUUsWUFBWSxFQUFFLENBQUM7SUFFM0QsTUFBTSxLQUFLLEdBQUcsSUFBSSxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDM0MsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDdEMsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbEQsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBRSxRQUFRLElBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDdEQsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN0RCxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxJQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ3ZEO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQWRhcHRlZCBmcm9tIHRoZSBiYXNlNjQtYXJyYXlidWZmZXIgcGFja2FnZSBpbXBsZW1lbnRhdGlvblxyXG4vLyAoaHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlciwgTUlUIGxpY2Vuc2VkKVxyXG5cclxuY29uc3QgQ0hBUlMgPSBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky9cIjtcclxuY29uc3QgRVFfQ0hBUiA9IFwiPVwiLmNoYXJDb2RlQXQoMCk7XHJcblxyXG4vLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguXHJcbmNvbnN0IGxvb2t1cCA9IG5ldyBVaW50OEFycmF5KDI1Nik7XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgQ0hBUlMubGVuZ3RoOyBpKyspIHtcclxuICBsb29rdXBbQ0hBUlMuY2hhckNvZGVBdChpKV0gPSBpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlKGJ5dGVzOiBVaW50OEFycmF5KTogc3RyaW5nIHtcclxuICBjb25zdCBsZW4gPSBieXRlcy5sZW5ndGg7XHJcbiAgbGV0IGJhc2U2NCA9IFwiXCI7XHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDMpIHtcclxuICAgIGNvbnN0IGIwID0gYnl0ZXNbaSArIDBdO1xyXG4gICAgY29uc3QgYjEgPSBieXRlc1tpICsgMV07XHJcbiAgICBjb25zdCBiMiA9IGJ5dGVzW2kgKyAyXTtcclxuICAgIGJhc2U2NCArPSBDSEFSUy5jaGFyQXQoYjAgPj4+IDIpO1xyXG4gICAgYmFzZTY0ICs9IENIQVJTLmNoYXJBdCgoKGIwICYgIDMpIDw8IDQpIHwgKGIxID4+PiA0KSk7XHJcbiAgICBiYXNlNjQgKz0gQ0hBUlMuY2hhckF0KCgoYjEgJiAxNSkgPDwgMikgfCAoYjIgPj4+IDYpKTtcclxuICAgIGJhc2U2NCArPSBDSEFSUy5jaGFyQXQoYjIgJiA2Myk7XHJcbiAgfVxyXG5cclxuICBpZiAobGVuICUgMyA9PT0gMikge1xyXG4gICAgYmFzZTY0ID0gYmFzZTY0LnN1YnN0cmluZygwLCBiYXNlNjQubGVuZ3RoIC0gMSkgKyBcIj1cIjtcclxuICB9IGVsc2UgaWYgKGxlbiAlIDMgPT09IDEpIHtcclxuICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgXCI9PVwiO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGJhc2U2NDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZShiYXNlNjQ6IHN0cmluZyk6IFVpbnQ4QXJyYXkge1xyXG4gIGNvbnN0IGxlbiA9IGJhc2U2NC5sZW5ndGg7XHJcbiAgbGV0IGJ1ZmZlckxlbmd0aCA9IGxlbiAqIDMgPj4+IDI7IC8vICogMC43NVxyXG5cclxuICBpZiAoYmFzZTY0LmNoYXJDb2RlQXQobGVuIC0gMSkgPT09IEVRX0NIQVIpIGJ1ZmZlckxlbmd0aC0tO1xyXG4gIGlmIChiYXNlNjQuY2hhckNvZGVBdChsZW4gLSAyKSA9PT0gRVFfQ0hBUikgYnVmZmVyTGVuZ3RoLS07XHJcblxyXG4gIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyTGVuZ3RoKTtcclxuICBmb3IgKGxldCBpID0gMCwgcCA9IDA7IGkgPCBsZW47IGkgKz0gNCkge1xyXG4gICAgY29uc3QgZW5jb2RlZDEgPSBsb29rdXBbYmFzZTY0LmNoYXJDb2RlQXQoaSArIDApXTtcclxuICAgIGNvbnN0IGVuY29kZWQyID0gbG9va3VwW2Jhc2U2NC5jaGFyQ29kZUF0KGkgKyAxKV07XHJcbiAgICBjb25zdCBlbmNvZGVkMyA9IGxvb2t1cFtiYXNlNjQuY2hhckNvZGVBdChpICsgMildO1xyXG4gICAgY29uc3QgZW5jb2RlZDQgPSBsb29rdXBbYmFzZTY0LmNoYXJDb2RlQXQoaSArIDMpXTtcclxuXHJcbiAgICBieXRlc1twKytdID0gKCBlbmNvZGVkMSAgICAgICA8PCAyKSB8IChlbmNvZGVkMiA+PiA0KTtcclxuICAgIGJ5dGVzW3ArK10gPSAoKGVuY29kZWQyICYgMTUpIDw8IDQpIHwgKGVuY29kZWQzID4+IDIpO1xyXG4gICAgYnl0ZXNbcCsrXSA9ICgoZW5jb2RlZDMgJiAzKSAgPDwgNikgfCAoZW5jb2RlZDQgJiA2Myk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gYnl0ZXM7XHJcbn1cclxuIl19","// This is not an enum to save some bytes in the output bundle.\r\nexport const SOLVER_TYPE_JS = 1;\r\nexport const SOLVER_TYPE_WASM = 2;\r\nexport const CHALLENGE_SIZE_BYTES = 128;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uc3RhbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2NvbnN0YW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrREFBK0Q7QUFDL0QsTUFBTSxDQUFDLE1BQU0sY0FBYyxHQUFHLENBQUMsQ0FBQztBQUNoQyxNQUFNLENBQUMsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7QUFFbEMsTUFBTSxDQUFDLE1BQU0sb0JBQW9CLEdBQUcsR0FBRyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhpcyBpcyBub3QgYW4gZW51bSB0byBzYXZlIHNvbWUgYnl0ZXMgaW4gdGhlIG91dHB1dCBidW5kbGUuXHJcbmV4cG9ydCBjb25zdCBTT0xWRVJfVFlQRV9KUyA9IDE7XHJcbmV4cG9ydCBjb25zdCBTT0xWRVJfVFlQRV9XQVNNID0gMjtcclxuXHJcbmV4cG9ydCBjb25zdCBDSEFMTEVOR0VfU0laRV9CWVRFUyA9IDEyODtcclxuIl19","// @ts-ignore\nimport css from \"./styles.css\";\nimport { ProgressMessage, DoneMessage } from \"./types\";\nimport { SOLVER_TYPE_JS } from \"friendly-pow/constants\";\nimport { Localization } from \"./localization\";\n\nconst loaderSVG = `<circle cx=\"12\" cy=\"12\" r=\"8\" stroke-width=\"3\" stroke-dasharray=\"15 10\" fill=\"none\" stroke-linecap=\"round\" transform=\"rotate(0 12 12)\"><animateTransform attributeName=\"transform\" type=\"rotate\" repeatCount=\"indefinite\" dur=\"0.9s\" values=\"0 12 12;360 12 12\"/></circle>`;\nconst errorSVG = `<path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/>`;\n\n/**\n * Base template used for all widget states\n * The reason we use raw string interpolation here is so we don't have to ship something like lit-html.\n */\nfunction getTemplate(fieldName: string, svgContent: string, textContent: string, solutionString: string, buttonText?: string, progress=false, debugData?: string) {\n    return `<div class=\"frc-container\">\n<svg class=\"frc-icon\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" height=\"32\" width=\"32\" viewBox=\"0 0 24 24\">${svgContent}</svg>\n<div class=\"frc-content\">\n    <span class=\"frc-text\" ${debugData? `title=\"${debugData}\"`:``}>${textContent}</span>\n    ${buttonText?`<button type=\"button\" class=\"frc-button\">${buttonText}</button>`:''}\n    ${progress?`<progress class=\"frc-progress\" value=\"0\">0%</progress>`:''}\n</div>\n</div><span class=\"frc-banner\"><a href=\"https://friendlycaptcha.com/\" rel=\"noopener\" style=\"text-decoration:none;\" target=\"_blank\"><b>Friendly</b>Captcha ⇗</a></span>\n<input name=\"${fieldName}\" class=\"frc-captcha-solution\" style=\"display: none;\" type=\"hidden\" value=\"${solutionString}\">`\n}\n\n/**\n * Used when the widget is ready to start solving.\n */\nexport function getReadyHTML(fieldName: string, l: Localization) {\n    return getTemplate(\n        fieldName,\n        `<path d=\"M17,11c0.34,0,0.67,0.04,1,0.09V6.27L10.5,3L3,6.27v4.91c0,4.54,3.2,8.79,7.5,9.82c0.55-0.13,1.08-0.32,1.6-0.55 C11.41,19.47,11,18.28,11,17C11,13.69,13.69,11,17,11z\"/><path d=\"M17,13c-2.21,0-4,1.79-4,4c0,2.21,1.79,4,4,4s4-1.79,4-4C21,14.79,19.21,13,17,13z M17,14.38\"/>`,\n        l.text_ready,\n        \".UNSTARTED\",\n        l.button_start,\n        false\n    )\n}\n\n\n/**\n * Used when the widget is retrieving a puzzle\n */\nexport function getFetchingHTML(fieldName: string, l: Localization) {\n    return getTemplate(\n        fieldName,\n        loaderSVG,\n        l.text_fetching,\n        \".FETCHING\",\n        undefined,\n        true\n    )\n}\n\n\n/**\n * Used when the solver is running, displays a progress bar.\n */\nexport function getRunningHTML(fieldName: string, l: Localization) {\n    return getTemplate(\n        fieldName,\n        loaderSVG,\n        l.text_solving,\n        \".UNFINISHED\",\n        undefined,\n        true\n    )\n}\n\nexport function getDoneHTML(fieldName: string, l: Localization, solution: string, data: DoneMessage) {\n    const timeData = `Completed: ${data.t.toFixed(0)}s (${(data.h/data.t*0.001).toFixed(0)}K/s)${data.solver === SOLVER_TYPE_JS ? \" JS Fallback\": \"\"}`;\n    return getTemplate(\n        fieldName,\n        `<title>${timeData}</title><path d=\"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z\"><animate attributeName=\"opacity\" dur=\"1.0s\" values=\"0;1\"/></path>`,\n        l.text_completed,\n        solution,\n        undefined,\n        false,\n        timeData\n    )\n}\n\nexport function getExpiredHTML(fieldName: string, l: Localization) {\n    return getTemplate(\n        fieldName,\n        errorSVG,\n        l.text_expired,\n        \".EXPIRED\",\n        l.button_restart\n    )\n}\n\nexport function getErrorHTML(fieldName: string, l: Localization, errorDescription: string, recoverable = true) {\n    return getTemplate(\n        fieldName,\n        errorSVG,\n        l.text_error + \" \" + errorDescription,\n        \".ERROR\",\n        recoverable ? l.button_retry: undefined,\n    )\n}\n\nexport function findCaptchaElements() {\n    const elements = document.querySelectorAll(\".frc-captcha\");\n    if (elements.length === 0) {\n        console.warn(\"FriendlyCaptcha: No div was found with .frc-captcha class\");\n    }\n    return elements;\n}\n\n/**\n * Injects the style if no #frc-style element is already present\n * (to support custom stylesheets)\n */\nexport function injectStyle() {\n    if (!document.querySelector(\"#frc-style\")) {\n        const styleSheet = document.createElement(\"style\")\n        styleSheet.type = \"text/css\";\n        styleSheet.id = \"frc-style\";\n        styleSheet.innerHTML = css\n        document.head.appendChild(styleSheet)\n    }\n}\n\n/**\n * @param element parent element of friendlycaptcha\n * @param progress value between 0 and 1\n */\nexport function updateProgressBar(element: HTMLElement, data: ProgressMessage) {\n    const p = element.querySelector(\".frc-progress\") as HTMLProgressElement;\n    const perc = (data.i+1)/data.n;\n    if (p) {\n        p.value = perc;\n        p.innerText = perc.toFixed(2) + \"%\"\n        p.title = (data.i+1) + \"/\" + data.n + \" (\" + (data.h/data.t*0.001).toFixed(0) + \"K/s)\";\n    }\n}\n\n/**\n * Traverses parent nodes until a <form> is found, returns null if not found.\n */\nexport function findParentFormElement(element: HTMLElement) {\n    while(element.tagName !== \"FORM\") {\n        element = element.parentElement as HTMLElement;\n        if (!element) {\n            return null;\n        }\n    }\n    return element;\n}\n\n/**\n * Add listener to specified element that will only fire once on focus.\n */\nexport function executeOnceOnFocusInEvent(element: HTMLElement, listener: (this: HTMLElement, fe: FocusEvent) => any) {\n    element.addEventListener(\"focusin\", listener, {once: true, passive: true});\n}\n","const nav = navigator;\nconst ua = nav.userAgent.toLowerCase();\n\n/**\n * Headless browser detection on the clientside is imperfect. One can modify any clientside code to disable or change this check,\n * and one can spoof whatever is checked here. However, that doesn't make it worthless: it's yet another hurdle for spammers and\n * it stops unsophisticated scripters from making any request whatsoever.\n */\nexport function isHeadless() {\n    let correctPrototypes = true;\n    try {\n        correctPrototypes = PluginArray.prototype === (nav.plugins as any).__proto__;\n        if (nav.plugins.length > 0) correctPrototypes = correctPrototypes &&  Plugin.prototype === (nav.plugins as any)[0].__proto__;\n    } catch(e){/* Do nothing, this browser misbehaves in mysterious ways */}\n\n    return ( //tell-tale bot signs\n        ua.indexOf(\"headless\") !== -1\n        || nav.appVersion.indexOf(\"Headless\") !== -1\n        || ua.indexOf(\"bot\") !== -1 // http://www.useragentstring.com/pages/useragentstring.php?typ=Browser\n        || ua.indexOf(\"crawl\") !== -1 // Only IE5 has two distributions that has this on windows NT.. so yeah.\n        || nav.webdriver === true\n        || !nav.language\n        || (nav.languages !== undefined && !nav.languages.length) // IE 11 does not support NavigatorLanguage.languages https://developer.mozilla.org/en-US/docs/Web/API/NavigatorLanguage/languages\n        || !correctPrototypes\n     );\n}\n","/**\r\n * Maps a value between 0 and 255 to a difficulty threshold (as uint32)\r\n * Difficulty 0 maps to 99.99% probability of being right on the first attempt\r\n * Anything above 250 needs 2^32 tries on average to solve.\r\n * 150 to 180 seems reasonable\r\n */\r\nexport function difficultyToThreshold(value) {\r\n    if (value > 255) {\r\n        value = 255;\r\n    }\r\n    else if (value < 0) {\r\n        value = 0;\r\n    }\r\n    return (Math.pow(2, (255.999 - value) / 8.0) >>> 0);\r\n}\r\n/**\r\n * Maps a value between 0 and 255 to a time duration in seconds that a puzzle is valid for.\r\n */\r\nexport function expiryToDurationInSeconds(value) {\r\n    if (value > 255) {\r\n        value = 255;\r\n    }\r\n    else if (value < 0) {\r\n        value = 0;\r\n    }\r\n    return value * 300;\r\n}\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5jb2RpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZW5jb2RpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0dBS0c7QUFDSCxNQUFNLFVBQVUscUJBQXFCLENBQUMsS0FBUztJQUMzQyxJQUFJLEtBQUssR0FBRyxHQUFHLEVBQUU7UUFDYixLQUFLLEdBQUcsR0FBRyxDQUFDO0tBQ2Y7U0FBTSxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUU7UUFDbEIsS0FBSyxHQUFHLENBQUMsQ0FBQztLQUNiO0lBRUQsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxHQUFJLEtBQWEsQ0FBQyxHQUFHLEdBQUcsQ0FBUSxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ3hFLENBQUM7QUFFRDs7R0FFRztBQUNILE1BQU0sVUFBVSx5QkFBeUIsQ0FBQyxLQUFTO0lBQy9DLElBQUksS0FBSyxHQUFHLEdBQUcsRUFBRTtRQUNiLEtBQUssR0FBRyxHQUFHLENBQUM7S0FDZjtTQUFNLElBQUksS0FBSyxHQUFHLENBQUMsRUFBRTtRQUNsQixLQUFLLEdBQUcsQ0FBQyxDQUFDO0tBQ2I7SUFFRCxPQUFRLEtBQWEsR0FBRyxHQUFHLENBQUM7QUFDaEMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBNYXBzIGEgdmFsdWUgYmV0d2VlbiAwIGFuZCAyNTUgdG8gYSBkaWZmaWN1bHR5IHRocmVzaG9sZCAoYXMgdWludDMyKVxyXG4gKiBEaWZmaWN1bHR5IDAgbWFwcyB0byA5OS45OSUgcHJvYmFiaWxpdHkgb2YgYmVpbmcgcmlnaHQgb24gdGhlIGZpcnN0IGF0dGVtcHRcclxuICogQW55dGhpbmcgYWJvdmUgMjUwIG5lZWRzIDJeMzIgdHJpZXMgb24gYXZlcmFnZSB0byBzb2x2ZS5cclxuICogMTUwIHRvIDE4MCBzZWVtcyByZWFzb25hYmxlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGlmZmljdWx0eVRvVGhyZXNob2xkKHZhbHVlOiB1OCk6IHUzMiB7XHJcbiAgICBpZiAodmFsdWUgPiAyNTUpIHtcclxuICAgICAgICB2YWx1ZSA9IDI1NTtcclxuICAgIH0gZWxzZSBpZiAodmFsdWUgPCAwKSB7XHJcbiAgICAgICAgdmFsdWUgPSAwO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiAoTWF0aC5wb3coMiwgKDI1NS45OTkgLSAodmFsdWUgYXMgZjY0KSkgLyA4LjApIGFzIHUzMiA+Pj4gMCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYXBzIGEgdmFsdWUgYmV0d2VlbiAwIGFuZCAyNTUgdG8gYSB0aW1lIGR1cmF0aW9uIGluIHNlY29uZHMgdGhhdCBhIHB1enpsZSBpcyB2YWxpZCBmb3IuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZXhwaXJ5VG9EdXJhdGlvbkluU2Vjb25kcyh2YWx1ZTogdTgpOiB1MzIge1xyXG4gICAgaWYgKHZhbHVlID4gMjU1KSB7XHJcbiAgICAgICAgdmFsdWUgPSAyNTU7XHJcbiAgICB9IGVsc2UgaWYgKHZhbHVlIDwgMCkge1xyXG4gICAgICAgIHZhbHVlID0gMDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKHZhbHVlIGFzIHUzMikgKiAzMDA7XHJcbn1cclxuIl19","import { getTimestampInSeconds } from \"./timestamp\";\r\nimport { expiryToDurationInSeconds } from \"./encoding\";\r\nimport { CHALLENGE_SIZE_BYTES } from \"./constants\";\r\nexport const PUZZLE_TIMESTAMP_OFFSET = 0;\r\nexport const ACCOUNT_ID_OFFSET = 4;\r\nexport const APP_ID_OFFSET = 8;\r\nexport const PUZZLE_VERSION_OFFSET = 12;\r\nexport const PUZZLE_EXPIRY_OFFSET = 13;\r\nexport const NUMBER_OF_PUZZLES_OFFSET = 14;\r\nexport const PUZZLE_DIFFICULTY_OFFSET = 15;\r\nexport const PUZZLE_NONCE_OFFSET = 24;\r\nexport const PUZZLE_USER_DATA_OFFSET = 32;\r\nexport const PUZZLE_USER_DATA_MAX_LENGTH = 32;\r\nconst VERSION = 1;\r\n/**\r\n * Generates a puzzle for FriendlyCaptcha.\r\n */\r\nexport function generatePuzzleBuffer(opts) {\r\n    var _a;\r\n    const numBytes = opts.userDataBuffer ? 32 + opts.userDataBuffer.length : 32;\r\n    const puzzle = new Uint8Array(numBytes);\r\n    const v = new DataView(puzzle.buffer);\r\n    const timeUint32 = opts.nowInSeconds === undefined ? getTimestampInSeconds() : opts.nowInSeconds;\r\n    v.setUint32(PUZZLE_TIMESTAMP_OFFSET, timeUint32);\r\n    v.setUint32(ACCOUNT_ID_OFFSET, opts.accountId);\r\n    v.setUint32(APP_ID_OFFSET, opts.appId);\r\n    v.setUint8(PUZZLE_VERSION_OFFSET, VERSION);\r\n    v.setUint8(PUZZLE_EXPIRY_OFFSET, opts.puzzleExpiry);\r\n    v.setUint8(NUMBER_OF_PUZZLES_OFFSET, opts.numberOfPuzzles);\r\n    v.setUint8(PUZZLE_DIFFICULTY_OFFSET, opts.puzzleDifficulty);\r\n    puzzle.set(opts.eightByteNonce, PUZZLE_NONCE_OFFSET);\r\n    if ((_a = opts.userDataBuffer) === null || _a === void 0 ? void 0 : _a.slice(0, PUZZLE_USER_DATA_MAX_LENGTH)) {\r\n        puzzle.set(opts.userDataBuffer, PUZZLE_USER_DATA_OFFSET);\r\n    }\r\n    return puzzle;\r\n}\r\nexport function getPuzzleSolverInputs(puzzleBuffer, numPuzzles) {\r\n    const startingPoints = [];\r\n    for (let i = 0; i < numPuzzles; i++) {\r\n        const input = new Uint8Array(CHALLENGE_SIZE_BYTES);\r\n        input.set(puzzleBuffer);\r\n        input[120] = i;\r\n        startingPoints.push(input);\r\n    }\r\n    return startingPoints;\r\n}\r\n/**\r\n * Combine multiple solutions (8 byte values) into a single array\r\n * @param solutions\r\n */\r\nexport function combineSolutions(solutions) {\r\n    const combined = new Uint8Array(solutions.length * 8);\r\n    for (let i = 0; i < solutions.length; i++) {\r\n        combined.set(solutions[i], i * 8);\r\n    }\r\n    return combined;\r\n}\r\n/**\r\n * Time in seconds the puzzle is valid for.\r\n * @param puzzleBuffer\r\n */\r\nexport function getPuzzleTTL(puzzleBuffer) {\r\n    return expiryToDurationInSeconds(puzzleBuffer[PUZZLE_EXPIRY_OFFSET]);\r\n}\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHV6emxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL3B1enpsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDcEQsT0FBTyxFQUFDLHlCQUF5QixFQUFFLE1BQU0sWUFBWSxDQUFDO0FBQ3RELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUVuRCxNQUFNLENBQUMsTUFBTSx1QkFBdUIsR0FBRyxDQUFDLENBQUM7QUFDekMsTUFBTSxDQUFDLE1BQU0saUJBQWlCLEdBQUcsQ0FBQyxDQUFDO0FBQ25DLE1BQU0sQ0FBQyxNQUFNLGFBQWEsR0FBRyxDQUFDLENBQUM7QUFDL0IsTUFBTSxDQUFDLE1BQU0scUJBQXFCLEdBQUcsRUFBRSxDQUFDO0FBQ3hDLE1BQU0sQ0FBQyxNQUFNLG9CQUFvQixHQUFHLEVBQUUsQ0FBQztBQUN2QyxNQUFNLENBQUMsTUFBTSx3QkFBd0IsR0FBRyxFQUFFLENBQUM7QUFDM0MsTUFBTSxDQUFDLE1BQU0sd0JBQXdCLEdBQUcsRUFBRSxDQUFDO0FBQzNDLE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHLEVBQUUsQ0FBQztBQUN0QyxNQUFNLENBQUMsTUFBTSx1QkFBdUIsR0FBRyxFQUFFLENBQUM7QUFFMUMsTUFBTSxDQUFDLE1BQU0sMkJBQTJCLEdBQUcsRUFBRSxDQUFDO0FBRTlDLE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQztBQUVsQjs7R0FFRztBQUNILE1BQU0sVUFBVSxvQkFBb0IsQ0FBQyxJQUE0Szs7SUFDN00sTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFFNUUsTUFBTSxNQUFNLEdBQUcsSUFBSSxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDeEMsTUFBTSxDQUFDLEdBQUcsSUFBSSxRQUFRLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRXRDLE1BQU0sVUFBVSxHQUFRLElBQUksQ0FBQyxZQUFZLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBRXRHLENBQUMsQ0FBQyxTQUFTLENBQUMsdUJBQXVCLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDakQsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDL0MsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3ZDLENBQUMsQ0FBQyxRQUFRLENBQUMscUJBQXFCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDM0MsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDcEQsQ0FBQyxDQUFDLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDM0QsQ0FBQyxDQUFDLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUU1RCxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztJQUNyRCxVQUFJLElBQUksQ0FBQyxjQUFjLDBDQUFFLEtBQUssQ0FBQyxDQUFDLEVBQUUsMkJBQTJCLEdBQUc7UUFDNUQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLHVCQUF1QixDQUFDLENBQUM7S0FDNUQ7SUFFRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDO0FBRUQsTUFBTSxVQUFVLHFCQUFxQixDQUFDLFlBQXdCLEVBQUUsVUFBa0I7SUFDOUUsTUFBTSxjQUFjLEdBQWlCLEVBQUUsQ0FBQztJQUV4QyxLQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ2hDLE1BQU0sS0FBSyxHQUFHLElBQUksVUFBVSxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDbkQsS0FBSyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4QixLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2YsY0FBYyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUM5QjtJQUNELE9BQU8sY0FBYyxDQUFDO0FBQzFCLENBQUM7QUFFRDs7O0dBR0c7QUFDSCxNQUFNLFVBQVUsZ0JBQWdCLENBQUMsU0FBdUI7SUFDcEQsTUFBTSxRQUFRLEdBQUcsSUFBSSxVQUFVLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztJQUN0RCxLQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUN0QyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUM7S0FDbkM7SUFDRCxPQUFPLFFBQVEsQ0FBQztBQUNwQixDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSxVQUFVLFlBQVksQ0FBQyxZQUF3QjtJQUNqRCxPQUFPLHlCQUF5QixDQUFDLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7QUFDekUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFRpbWVzdGFtcEluU2Vjb25kcyB9IGZyb20gXCIuL3RpbWVzdGFtcFwiO1xyXG5pbXBvcnQge2V4cGlyeVRvRHVyYXRpb25JblNlY29uZHMgfSBmcm9tIFwiLi9lbmNvZGluZ1wiO1xyXG5pbXBvcnQgeyBDSEFMTEVOR0VfU0laRV9CWVRFUyB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IFBVWlpMRV9USU1FU1RBTVBfT0ZGU0VUID0gMDtcclxuZXhwb3J0IGNvbnN0IEFDQ09VTlRfSURfT0ZGU0VUID0gNDtcclxuZXhwb3J0IGNvbnN0IEFQUF9JRF9PRkZTRVQgPSA4O1xyXG5leHBvcnQgY29uc3QgUFVaWkxFX1ZFUlNJT05fT0ZGU0VUID0gMTI7XHJcbmV4cG9ydCBjb25zdCBQVVpaTEVfRVhQSVJZX09GRlNFVCA9IDEzO1xyXG5leHBvcnQgY29uc3QgTlVNQkVSX09GX1BVWlpMRVNfT0ZGU0VUID0gMTQ7XHJcbmV4cG9ydCBjb25zdCBQVVpaTEVfRElGRklDVUxUWV9PRkZTRVQgPSAxNTtcclxuZXhwb3J0IGNvbnN0IFBVWlpMRV9OT05DRV9PRkZTRVQgPSAyNDtcclxuZXhwb3J0IGNvbnN0IFBVWlpMRV9VU0VSX0RBVEFfT0ZGU0VUID0gMzI7XHJcblxyXG5leHBvcnQgY29uc3QgUFVaWkxFX1VTRVJfREFUQV9NQVhfTEVOR1RIID0gMzI7XHJcblxyXG5jb25zdCBWRVJTSU9OID0gMTtcclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgYSBwdXp6bGUgZm9yIEZyaWVuZGx5Q2FwdGNoYS5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVB1enpsZUJ1ZmZlcihvcHRzOiB7bm93SW5TZWNvbmRzPzogdTMyOyBhY2NvdW50SWQ6IHUzMjsgYXBwSWQ6IHUzMjsgbnVtYmVyT2ZQdXp6bGVzOiB1ODsgcHV6emxlRXhwaXJ5OiB1ODsgcHV6emxlRGlmZmljdWx0eTogdTg7IGVpZ2h0Qnl0ZU5vbmNlOiBVaW50OEFycmF5OyB1c2VyRGF0YUJ1ZmZlcj86IFVpbnQ4QXJyYXl9KTogVWludDhBcnJheSB7XHJcbiAgICBjb25zdCBudW1CeXRlcyA9IG9wdHMudXNlckRhdGFCdWZmZXIgPyAzMiArIG9wdHMudXNlckRhdGFCdWZmZXIubGVuZ3RoIDogMzI7XHJcbiAgICBcclxuICAgIGNvbnN0IHB1enpsZSA9IG5ldyBVaW50OEFycmF5KG51bUJ5dGVzKTtcclxuICAgIGNvbnN0IHYgPSBuZXcgRGF0YVZpZXcocHV6emxlLmJ1ZmZlcik7XHJcblxyXG4gICAgY29uc3QgdGltZVVpbnQzMjogdTMyID0gb3B0cy5ub3dJblNlY29uZHMgPT09IHVuZGVmaW5lZCA/IGdldFRpbWVzdGFtcEluU2Vjb25kcygpIDogb3B0cy5ub3dJblNlY29uZHM7XHJcblxyXG4gICAgdi5zZXRVaW50MzIoUFVaWkxFX1RJTUVTVEFNUF9PRkZTRVQsIHRpbWVVaW50MzIpO1xyXG4gICAgdi5zZXRVaW50MzIoQUNDT1VOVF9JRF9PRkZTRVQsIG9wdHMuYWNjb3VudElkKTtcclxuICAgIHYuc2V0VWludDMyKEFQUF9JRF9PRkZTRVQsIG9wdHMuYXBwSWQpO1xyXG4gICAgdi5zZXRVaW50OChQVVpaTEVfVkVSU0lPTl9PRkZTRVQsIFZFUlNJT04pO1xyXG4gICAgdi5zZXRVaW50OChQVVpaTEVfRVhQSVJZX09GRlNFVCwgb3B0cy5wdXp6bGVFeHBpcnkpO1xyXG4gICAgdi5zZXRVaW50OChOVU1CRVJfT0ZfUFVaWkxFU19PRkZTRVQsIG9wdHMubnVtYmVyT2ZQdXp6bGVzKTtcclxuICAgIHYuc2V0VWludDgoUFVaWkxFX0RJRkZJQ1VMVFlfT0ZGU0VULCBvcHRzLnB1enpsZURpZmZpY3VsdHkpO1xyXG5cclxuICAgIHB1enpsZS5zZXQob3B0cy5laWdodEJ5dGVOb25jZSwgUFVaWkxFX05PTkNFX09GRlNFVCk7XHJcbiAgICBpZiAob3B0cy51c2VyRGF0YUJ1ZmZlcj8uc2xpY2UoMCwgUFVaWkxFX1VTRVJfREFUQV9NQVhfTEVOR1RIKSkge1xyXG4gICAgICAgIHB1enpsZS5zZXQob3B0cy51c2VyRGF0YUJ1ZmZlciwgUFVaWkxFX1VTRVJfREFUQV9PRkZTRVQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwdXp6bGU7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQdXp6bGVTb2x2ZXJJbnB1dHMocHV6emxlQnVmZmVyOiBVaW50OEFycmF5LCBudW1QdXp6bGVzOiBudW1iZXIpOiBVaW50OEFycmF5W10ge1xyXG4gICAgY29uc3Qgc3RhcnRpbmdQb2ludHM6IFVpbnQ4QXJyYXlbXSA9IFtdO1xyXG5cclxuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBudW1QdXp6bGVzOyBpKyspIHtcclxuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBVaW50OEFycmF5KENIQUxMRU5HRV9TSVpFX0JZVEVTKTtcclxuICAgICAgICBpbnB1dC5zZXQocHV6emxlQnVmZmVyKTtcclxuICAgICAgICBpbnB1dFsxMjBdID0gaTtcclxuICAgICAgICBzdGFydGluZ1BvaW50cy5wdXNoKGlucHV0KTtcclxuICAgIH1cclxuICAgIHJldHVybiBzdGFydGluZ1BvaW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqIENvbWJpbmUgbXVsdGlwbGUgc29sdXRpb25zICg4IGJ5dGUgdmFsdWVzKSBpbnRvIGEgc2luZ2xlIGFycmF5XHJcbiAqIEBwYXJhbSBzb2x1dGlvbnMgXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tYmluZVNvbHV0aW9ucyhzb2x1dGlvbnM6IFVpbnQ4QXJyYXlbXSk6IFVpbnQ4QXJyYXkge1xyXG4gICAgY29uc3QgY29tYmluZWQgPSBuZXcgVWludDhBcnJheShzb2x1dGlvbnMubGVuZ3RoICogOCk7XHJcbiAgICBmb3IobGV0IGkgPSAwOyBpIDwgc29sdXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29tYmluZWQuc2V0KHNvbHV0aW9uc1tpXSwgaSo4KTtcclxuICAgIH1cclxuICAgIHJldHVybiBjb21iaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRpbWUgaW4gc2Vjb25kcyB0aGUgcHV6emxlIGlzIHZhbGlkIGZvci5cclxuICogQHBhcmFtIHB1enpsZUJ1ZmZlciBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQdXp6bGVUVEwocHV6emxlQnVmZmVyOiBVaW50OEFycmF5KSB7XHJcbiAgICByZXR1cm4gZXhwaXJ5VG9EdXJhdGlvbkluU2Vjb25kcyhwdXp6bGVCdWZmZXJbUFVaWkxFX0VYUElSWV9PRkZTRVRdKTtcclxufVxyXG4iXX0=","import { decode } from \"friendly-pow/base64\";\nimport { difficultyToThreshold } from \"friendly-pow/encoding\";\nimport { NUMBER_OF_PUZZLES_OFFSET, PUZZLE_DIFFICULTY_OFFSET, PUZZLE_EXPIRY_OFFSET } from \"friendly-pow/puzzle\";\n\nexport interface Puzzle {\n    signature: string;\n    base64: string;\n    buffer: Uint8Array; // input puzzle\n    threshold: number; // Related to difficulty\n    n: number; // Amount of puzzles to solve\n    expiry: number; // Expiry in milliseconds from now\n}\n\nexport function decodeBase64Puzzle(base64Puzzle: string): Puzzle {\n    const parts = base64Puzzle.split(\".\");\n    const puzzle = parts[1];\n    const arr = decode(puzzle);\n    return {\n        signature: parts[0],\n        base64: puzzle,\n        buffer: arr,\n        n: arr[NUMBER_OF_PUZZLES_OFFSET],\n        threshold: difficultyToThreshold(arr[PUZZLE_DIFFICULTY_OFFSET]),\n        expiry: arr[PUZZLE_EXPIRY_OFFSET] * 300000,\n    }\n}\n\nexport async function getPuzzle(url: string, siteKey: string): Promise<string> {\n    const urls = url.split(\",\");\n    for (let i = 0; i < urls.length; i++) {\n        const response = await fetchAndRetryWithBackoff(url + \"?sitekey=\" + siteKey, {headers: [[\"x-frc-client\", \"js-0.8.4\"]], mode: 'cors'}, 2);\n        if (response.ok) {\n            const json = await response.json();\n            return json.data.puzzle;\n        } else {\n            let json;\n            try {\n                json = await response.json();\n            } catch(e) {\n                /* Do nothing */\n            }\n\n            if (json && json.errors && json.errors[0] === \"endpoint_not_enabled\") {\n                throw Error(`Endpoint not allowed (${response.status})`);\n            }\n            \n            if (i === urls.length-1) {\n                throw Error(`Failure in getting puzzle: ${response.status} ${response.statusText}`);\n            }\n        }\n    }\n    // This code should never be reached.\n    throw Error(`Internal error`);\n}\n\n/**\n * Retries given request with exponential backoff (starting with 100ms delay, multiplying by 4 every time)\n * @param url Request (can be string url) to fetch\n * @param opts Options for fetch\n * @param n Number of times to attempt before giving up.\n */\nexport async function fetchAndRetryWithBackoff(url: RequestInfo, opts: RequestInit, n: number): Promise<Response> {\n    let time = 500;\n    return fetch(url, opts).catch(async (error) => {\n        if (n === 1) throw error;\n        await new Promise(r => setTimeout(r, time));\n        time *= 4;\n        return fetchAndRetryWithBackoff(url, opts, n - 1);\n    });\n}\n","// Tip: keep the messages short, there isn't a lot of space in the widget\nexport interface Localization {\n    // While the widget is starting: usually not visible as it initializes instantly.\n    text_init: string;\n\n    // Before the widget is started\n    text_ready: string;\n    button_start: string;\n\n    // While the widget is downloading a puzzle (usually only takes a split second)\n    // If this is hard to translate, you could put something simple like \"Loading..\"\n    text_fetching: string;\n\n    // While the widget is solving\n    text_solving: string;\n\n    // Completed\n    text_completed: string;\n\n    // Expired (the puzzle was solved, but then waited say a day without submitting)\n    text_expired: string;\n    button_restart: string;\n\n    // Error\n    text_error: string; // Should end with a colon (:), the error is shown after it.\n    button_retry: string;\n}\n\n// English\nconst LANG_EN: Localization = {\n    text_init: \"Initializing..\",\n\n    text_ready: \"Anti-Robot Verification\",\n    button_start: \"Click to start verification\",\n\n    text_fetching: \"Fetching Challenge\",\n\n    text_solving: \"Verifying you are human..\",\n    text_completed: \"I am human\",\n\n    text_expired: \"Anti-Robot verification expired\",\n    button_restart: \"Restart\",\n\n    text_error: \"Verification failed:\",\n    button_retry: \"Retry\",\n}\n\n// French\nconst LANG_FR: Localization = {\n    text_init: \"Chargement..\",\n\n    text_ready: \"Verification Anti-Robot\",\n    button_start: \"Cliquez ici pour vérifier\",\n\n    text_fetching: \"Chargement du challenge\",\n\n    text_solving: \"Vérification que vous êtes humain..\",\n    text_completed: \"Je suis humain\",\n\n    text_expired: \"Verification échue\",\n    button_restart: \"Recommencer\",\n\n    text_error: \"Echec de verification:\",\n    button_retry: \"Recommencer\",\n}\n\n// German\nconst LANG_DE: Localization = {\n    text_init: \"Initialisierung..\",\n\n    text_ready: \"Anti-Roboter-Verifizierung\",\n    button_start: \"Hier klicken\",\n\n    text_fetching: \"Herausforderung laden..\",\n\n    text_solving: \"Verifizierung, dass Sie ein Mensch sind..\",\n    text_completed: \"Ich bin ein Mensch\",\n\n    text_expired: \"Verifizierung abgelaufen\",\n    button_restart: \"Erneut starten\",\n\n    text_error: \"Verifizierung fehlgeschlagen:\",\n    button_retry: \"Erneut versuchen\",   \n}\n\n// Dutch\nconst LANG_NL: Localization = {\n    text_init: \"Initializeren..\",\n\n    text_ready: \"Anti-robotverificatie\",\n    button_start: \"Klik om te starten\",\n\n    text_fetching: \"Aan het laden..\",\n\n    text_solving: \"Anti-robotverificatie bezig..\",\n    text_completed: \"Ik ben een mens\",\n\n    text_expired: \"Verificatie verlopen\",\n    button_restart: \"Opnieuw starten\",\n\n    text_error: \"Verificatie mislukt:\",\n    button_retry: \"Opnieuw proberen\",   \n}\n\n// Italian\nconst LANG_IT: Localization = {\n    text_init: \"Inizializzazione...\",\n\n    text_ready: \"Verifica Anti-Robot\",\n    button_start: \"Clicca per iniziare\",\n\n    text_fetching: \"Caricamento...\",\n\n    text_solving: \"Verificando che sei umano...\",\n    text_completed: \"Non sono un robot\",\n\n    text_expired: \"Verifica Anti-Robot scaduta\",\n    button_restart: \"Ricomincia\",\n\n    text_error: \"Verifica fallita:\",\n    button_retry: \"Riprova\",\n}\n\nexport const localizations = {\n    en: LANG_EN,\n    de: LANG_DE,\n    nl: LANG_NL,\n    fr: LANG_FR,\n    it: LANG_IT,\n}\n","import { base64 } from 'friendly-pow/wasm/optimized.wrap';\nimport { decode, encode } from 'friendly-pow/base64';\nimport { getRunningHTML, getReadyHTML, getDoneHTML, updateProgressBar, findParentFormElement, executeOnceOnFocusInEvent, getErrorHTML, getFetchingHTML, injectStyle, getExpiredHTML } from './dom';\n// @ts-ignore\nimport workerString from '../dist/worker.min.js';\nimport { isHeadless } from \"./headless\";\nimport { DoneMessage, ProgressMessage } from './types';\nimport { Puzzle, decodeBase64Puzzle, getPuzzle } from './puzzle';\nimport { Localization, localizations } from './localization';\n\nconst PUZZLE_ENDPOINT_URL = \"https://api.friendlycaptcha.com/api/v1/puzzle\";\nconst URL = window.URL || window.webkitURL;\n\nexport interface WidgetInstanceOptions {\n    forceJSFallback: boolean;\n    startMode: \"auto\" | \"focus\" | \"none\";\n    puzzleEndpoint: string;\n    language: \"en\" | \"de\" | \"nl\" | \"fr\" | \"it\" | Localization;\n    solutionFieldName: \"frc-captcha-solution\";\n\n    sitekey: string,\n\n    readyCallback: () => any;\n    startedCallback: () => any;\n    doneCallback: (solution: string) => any;\n    errorCallback: (error: any) => any;\n}\n\nexport class WidgetInstance {\n    private worker: Worker | null = null;\n    private puzzle?: Puzzle;\n\n    /**\n     * The root element of this widget instance.\n     * Warning: it is undefined after `destroy()` has been called.\n     */\n    private e!: HTMLElement;\n\n    /**\n     * The captcha has been succesfully solved.\n     */\n    public valid = false;\n    private opts: WidgetInstanceOptions;\n\n    /**\n     * Some errors may cause a need for the (worker) to be reinitialized. If this is\n     * true `init` will be called again when start is called.\n     */\n    private needsReInit = false;\n\n    /**\n     * Start() has been called at least once ever.\n     */\n    private hasBeenStarted = false;\n\n    private hasBeenDestroyed = false;\n\n    private lang: Localization;\n\n    constructor(element: HTMLElement, options: Partial<WidgetInstanceOptions> = {}) {\n        this.opts = Object.assign({\n            forceJSFallback: false,\n            startMode: \"focus\",\n            puzzleEndpoint: element.dataset[\"puzzleEndpoint\"] || PUZZLE_ENDPOINT_URL,\n            startedCallback: () => 0,\n            readyCallback: () => 0,\n            doneCallback: () => 0,\n            errorCallback: () => 0,\n            sitekey: element.dataset[\"sitekey\"] || \"\",\n            language: element.dataset[\"lang\"] || \"en\",\n            solutionFieldName: element.dataset[\"solutionFieldName\"] || \"frc-captcha-solution\"\n        }, options);\n        this.e = element;\n        \n        // Load language\n        if (typeof this.opts.language === \"string\") {\n            let l = (localizations as any)[this.opts.language.toLowerCase()];\n            if (l === undefined) {\n                console.error(\"FriendlyCaptcha: language \\\"\"+this.opts.language+\"\\\" not found.\");\n                // Fall back to English\n                l = localizations.en;\n            }\n            this.lang = l;\n        } else {\n            // We assign to a copy of the English language localization, so that any missing values will be English\n            this.lang = Object.assign(Object.assign({}, localizations.en), this.opts.language)\n        }\n\n        element.innerText = this.lang.text_init;\n        injectStyle();\n        this.init(this.opts.startMode === \"auto\" || this.e.dataset[\"start\"] === \"auto\");\n    }\n\n    public init(forceStart?: boolean) {\n        if (this.hasBeenDestroyed) {\n            console.error(\"FriendlyCaptcha widget has been destroyed using destroy(), it can not be used anymore.\");\n            return;\n        }\n        this.initWorker();\n        this.setupSolver();\n\n        if (forceStart) {\n            this.start();\n        } else if (this.e.dataset[\"start\"] !== \"none\" && (this.opts.startMode === \"focus\" || this.e.dataset[\"start\"] === \"focus\")) {\n            const form = findParentFormElement(this.e);\n            if (form) {\n                executeOnceOnFocusInEvent(form, () => {\n                    if (!this.hasBeenStarted) {\n                        this.start();\n                    }\n                });\n            } else {\n                console.log(\"FriendlyCaptcha div seems not to be contained in a form, autostart will not work\");\n            }\n        }\n    }\n\n    /**\n     * Compile the WASM and send the compiled module to the webworker. \n     * If WASM support is not present, it tells the webworker to initialize the JS solver instead.\n     */\n    private async setupSolver() {\n        if (this.opts.forceJSFallback) {\n            this.worker!.postMessage({type: \"js\"});\n            return;\n        }\n        try {\n            const module = WebAssembly.compile(decode(base64));\n            this.worker!.postMessage({type: \"module\", module: await module});\n        } catch (e) {\n            console.log(\"FriendlyCaptcha failed to initialize WebAssembly, falling back to Javascript solver: \" + e.toString());\n            this.worker!.postMessage({type: \"js\"});\n        }\n    }\n\n    /**\n     * Add a listener to the button that calls `this.start` on click.\n     */\n    private makeButtonStart() {\n        const b = this.e.querySelector(\"button\");\n        if (b) {\n            b.addEventListener(\"click\", (e) => this.start(), {once: true, passive: true});\n            b.addEventListener(\"touchstart\", (e) => this.start(), {once: true, passive: true});\n        }\n    }\n\n    private onWorkerError(e: any) {\n        this.needsReInit = true;\n        this.e.innerHTML = getErrorHTML(this.opts.solutionFieldName, this.lang, \"Background worker error \" + e.message);\n        this.makeButtonStart();\n\n        // Just out of precaution\n        this.opts.forceJSFallback = true;\n    }\n\n    private initWorker() {\n        if (this.worker) this.worker.terminate();\n\n        const workerBlob = new Blob([workerString] as any, { type: \"text/javascript\" });\n        this.worker = new Worker(URL.createObjectURL(workerBlob));\n        this.worker.onerror = (e: ErrorEvent) => this.onWorkerError(e);\n\n        this.worker.onmessage = (e: any) => {\n            if (this.hasBeenDestroyed) return;\n\n            const data = e.data;\n            if (!data) return;\n            if (data.type === \"progress\") {\n                updateProgressBar(this.e, data as ProgressMessage);\n            } else if (data.type === \"ready\") {\n                this.e.innerHTML = getReadyHTML(this.opts.solutionFieldName, this.lang);\n                this.makeButtonStart();\n                this.opts.readyCallback();\n            } else if (data.type === \"started\") {\n                this.e.innerHTML = getRunningHTML(this.opts.solutionFieldName, this.lang);\n                this.opts.startedCallback();\n            } else if (data.type === \"done\") {\n                const solutionPayload = this.handleDone(data);\n                this.opts.doneCallback(solutionPayload);\n                const callback = this.e.dataset[\"callback\"];\n                if (callback) {\n                    (window as any)[callback](solutionPayload);\n                }\n            } else if (data.type === \"error\") {\n                this.onWorkerError(data);\n            }\n        };\n    }\n\n    private expire() {\n        this.e.innerHTML = getExpiredHTML(this.opts.solutionFieldName, this.lang);\n        this.makeButtonStart();\n    }\n\n    public async start() {\n        if (this.hasBeenDestroyed) {\n            console.error(\"Can not start FriendlyCaptcha widget which has been destroyed\")\n            return;\n        }\n\n        this.hasBeenStarted = true;\n        const sitekey = this.opts.sitekey || this.e.dataset[\"sitekey\"];\n        if (!sitekey) {\n            console.error(\"FriendlyCaptcha: sitekey not set on frc-captcha element\");\n            this.e.innerHTML = getErrorHTML(this.opts.solutionFieldName, this.lang, \"Website problem: sitekey not set\", false);\n            return;\n        }\n\n        if (isHeadless()) {\n            this.e.innerHTML = getErrorHTML(this.opts.solutionFieldName, this.lang, \"Browser check failed, try a different browser\", false);\n            return;\n        }\n\n        if (this.needsReInit) {\n            this.needsReInit = false;\n            this.init(true);\n            return;\n        }\n\n        try {\n            this.e.innerHTML = getFetchingHTML(this.opts.solutionFieldName, this.lang);\n            this.puzzle = decodeBase64Puzzle(await getPuzzle(this.opts.puzzleEndpoint, sitekey));\n            setTimeout(() => this.expire(), this.puzzle.expiry - 30000); // 30s grace\n        } catch(e) {\n            this.e.innerHTML = getErrorHTML(this.opts.solutionFieldName, this.lang, e.toString());\n            this.makeButtonStart();\n            const code = \"error_getting_puzzle\";\n\n            this.opts.errorCallback({code, description: e.toString(), error: e});\n            const callback = this.e.dataset[\"callback-error\"];\n            if (callback) {\n                (window as any)[callback](this);\n            }\n            return;\n        }\n        this.worker!.postMessage({type: \"start\", buffer: this.puzzle!.buffer, n: this.puzzle!.n, threshold: this.puzzle!.threshold});\n    }\n\n    /**\n     * This is to be called when the puzzle has been succesfully completed.\n     * Here the hidden field gets updated with the solution.\n     * @param data message from the webworker\n     */\n    private handleDone(data: DoneMessage) {\n        this.valid = true;\n        const puzzleSolutionMessage = `${this.puzzle!.signature}.${this.puzzle!.base64}.${encode(data.solution)}.${encode(data.diagnostics)}`;\n        this.e.innerHTML = getDoneHTML(this.opts.solutionFieldName, this.lang, puzzleSolutionMessage, data);\n        if (this.worker) this.worker.terminate();\n        // this.worker = null; // This literally crashes very old browsers..\n        this.needsReInit = true;\n        \n        return puzzleSolutionMessage;\n    }\n\n    /**\n     * Cleans up the widget entirely, removing any DOM elements and terminating any background workers.\n     * After it is destroyed it can no longer be used for any purpose.\n     */\n    public destroy() {\n        if (this.worker) this.worker.terminate();\n        this.worker = null;\n        this.needsReInit = false;\n        this.hasBeenStarted = false;\n        if (this.e) {\n            this.e.remove();\n            delete this.e;\n        }\n        this.hasBeenDestroyed = true;\n    }\n\n    /**\n     * Resets the widget to the initial state.\n     * This is useful in situations where the page does not refresh when you submit and the form may be re-submitted again\n     */\n    public reset() {\n        if (this.hasBeenDestroyed) {\n            console.error(\"FriendlyCaptcha widget has been destroyed, it can not be used anymore\");\n            return;\n        }\n\n        if (this.worker) this.worker.terminate();\n        this.worker = null;\n        this.needsReInit = false;\n        this.hasBeenStarted = false;\n        this.init(this.opts.startMode === \"auto\" || this.e.dataset[\"start\"] === \"auto\");\n    }\n}\n"],"names":[],"mappings":"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"}